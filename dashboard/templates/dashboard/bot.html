{% extends "dashboard/base.html" %}

{% load static %}

{% load custom_tags %}

{% block basebody %}

<head>




</head>
 

<div>
    <!-- <button class="btn btn-primary" onclick="bot_download_data();">download</button> -->
    <!-- <button class="btn btn-primary" onclick="bot_import_data();">import</button> -->

    <button class="btn btn-primary" onclick="bot_draw_data();">draw local pandas</button>
</div>


<div class="d-flex justify-content-start gap-3 mt-5">
    <p>Time frame:</p>
    <select id="time_frame_minutes__select" class="form-select form-select-sm" style="width: 70px;">
        {% for minute in admin_settings.MINUTES %}
            <option value="{{minute}}" {% if admin_settings.active_time_frame_minutes == minute %} selected {% endif %}>{{minute}}</option>
        {% endfor %}
    </select>

    <p>Show last minutes:</p>
    <input type="number"  class="form-control form-control-sm" min="1" step="1" id="steps__input" value="{{admin_settings.active_time_frame_length}}"   style="width: 120px;"/>

    <button class="btn btn-success" onclick="bot_save_settings();">Save chart settings</button>

</div>

<div class="mt-5 border rounded p-2">
    <button class="btn btn-primary"     onclick="db_check();"           >DB check</button>
    <button class="btn btn-warning"     onclick="db_import_csv();"      >DB import CSV</button>
</div>

<!-- <div class="mt-5 border rounded p-2 " > -->
    <!-- <button class="btn btn-primary"     onclick="db_backup();"          >DB back up</button> -->
    <!-- <button class="btn btn-warning"     onclick="db_restore();"         >DB restore</button> -->
    <button class="btn btn-danger"      onclick="db_nullify_indicators();">DB nullify indicators</button>
    <button class="btn btn-danger"      onclick="db_truncate();"     hidden   >DB truncate</button>
<!-- </div> -->

<div class="m-5">

    <h4>Long observation</h4>
    <div class="d-flex justify-content-between border rounded p-2">
        <div class="w-50">
            <p class="h5 text-success">Pro</p>
            <div id="pro_long_observations__div"></div>
        </div>
        <div class="w-50">
            <p class="h5 text-danger">Against</p>
            <div id="against_long_observations__div"></div>
        </div>
    </div>

    <h4 class="mt-5">Short observation</h4>
    <div class="d-flex justify-content-between border rounded p-2">
        <div class="w-50">
            <p class="h5 text-success">Pro</p>
            <div id="pro_short_observations__div"></div>
        </div>
        <div class="w-50">
            <p class="h5 text-danger">Against</p>
            <div id="against_short_observations__div"></div>
        </div>
    </div>


</div>

<table class="table mt-5">
    <thead id="indicators_table__head">

    </thead>
    <tbody id="indicators_table__body">

    </tbody>
</table>

<div id="anychart_chart_container" class="mt-3" style="width: 100%; height: 2000px;"></div>

<div id="bot_price_plot"></div>


<script>

    function bot_download_data(){   ajax_call('bot_download',       {})};
    function bot_import_data(){     ajax_call('bot_import_data',    {})};
    function bot_draw_data(){       ajax_call('bot_draw_data',      {"time_frame_minutes": $('#time_frame_minutes__select').val(), "steps": $('#steps__input').val()})};
    
    function bot_save_settings(){   ajax_call('bot_save_settings',  {"time_frame_minutes": $('#time_frame_minutes__select').val(), "steps": $('#steps__input').val()})};

    function db_import_csv(){           ajax_call('db_import_csv',          {'time_frame_minutes': $('#time_frame_minutes__select').val()})};
    function db_backup(){               ajax_call('db_backup',              {'time_frame_minutes': $('#time_frame_minutes__select').val()})};
    function db_restore(){              ajax_call('db_restore',             {'time_frame_minutes': $('#time_frame_minutes__select').val()})};
    function db_nullify_indicators(){   ajax_call('db_nullify_indicators',  {'time_frame_minutes': $('#time_frame_minutes__select').val()})};
    function db_truncate(){             ajax_call('db_truncate',            {'time_frame_minutes': $('#time_frame_minutes__select').val()})};
    function db_check(){                ajax_call('db_check',               {'time_frame_minutes': $('#time_frame_minutes__select').val()})};

    $(document).ready(function () {
        setup_ws_dashboard();
    })

</script>


    



{% endblock %}
